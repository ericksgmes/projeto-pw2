<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciamento de Restaurante</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<header>
    <h1>Restaurante Webservice</h1>
    <nav>
        <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#login" class="restricted">Login</a></li>
            <li><a href="#funcionarios" class="restricted" style="display: none;">Funcionários</a></li>
            <li><a href="#mesas" class="restricted" style="display: none;">Mesas</a></li>
            <li><a href="#produtos" class="restricted" style="display: none;">Produtos</a></li>
            <li><a href="#pagamentos" class="restricted" style="display: none;">Pagamentos</a></li>
        </ul>
    </nav>
</header>

<main>
    <section id="home" class="section">
        <h2>Bem-vindo ao Gerenciamento de Restaurante</h2>
        <p>Abaixo estão todos os produtos disponíveis no restaurante:</p>
        <div id="lista-produtos-home"></div>
    </section>

    <section id="login" class="section active">
        <h2>Login</h2>
        <form id="form-login">
            <input type="text" id="username-login" placeholder="Username" required>
            <input type="password" id="senha-login" placeholder="Senha" required>
            <button type="submit">Login</button>
        </form>
    </section>

    <section id="funcionarios" class="section">
        <h2>Gerenciamento de Funcionários</h2>
        <div id="lista-funcionarios"></div>
        <form id="form-funcionario">
            <input type="text" id="nome-funcionario" placeholder="Nome do Funcionário" required>
            <input type="text" id="username-funcionario" placeholder="Username" required>
            <input type="password" id="senha-funcionario" placeholder="Senha" required>
            <button type="submit">Adicionar Funcionário</button>
        </form>
    </section>

    <section id="mesas" class="section">
        <h2>Gerenciamento de Mesas</h2>
        <div id="lista-mesas"></div>
        <form id="form-mesa">
            <input type="number" id="numero-mesa" placeholder="Número da Mesa" required>
            <button type="submit">Adicionar Mesa</button>
        </form>
    </section>

    <section id="produtos" class="section">
        <h2>Gerenciamento de Produtos</h2>
        <div id="lista-produtos"></div>
        <form id="form-produto">
            <input type="text" id="nome-produto" placeholder="Nome do Produto" required>
            <input type="number" step="0.01" id="preco-produto" placeholder="Preço do Produto" required>
            <button type="submit">Adicionar Produto</button>
        </form>
    </section>

    <section id="pagamentos" class="section">
        <h2>Gerenciamento de Pagamentos</h2>
        <div id="lista-pagamentos"></div>
        <form id="form-pagamento">
            <input type="number" id="id-mesa-pagamento" placeholder="ID da Mesa" required>
            <input type="text" id="metodo-pagamento" placeholder="Método de Pagamento" required>
            <input type="number" step="0.01" id="valor-pagamento" placeholder="Valor do Pagamento" required>
            <button type="submit">Adicionar Pagamento</button>
        </form>
    </section>

    <section id="editar-funcionario" class="section">
        <h2>Editar Funcionário</h2>
        <form id="form-editar-funcionario">
            <input type="text" id="editar-nome-funcionario" placeholder="Nome do Funcionário" required>
            <input type="text" id="editar-username-funcionario" placeholder="Username" required>
            <button type="submit">Salvar Alterações</button>
        </form>
    </section>

    <section id="editar-mesa" class="section">
        <h2>Editar Mesa</h2>
        <form id="form-editar-mesa">
            <input type="number" id="editar-numero-mesa" placeholder="Número da Mesa" required>
            <button type="submit">Salvar Alterações</button>
        </form>
    </section>

    <section id="editar-produto" class="section">
        <h2>Editar Produto</h2>
        <form id="form-editar-produto">
            <input type="text" id="editar-nome-produto" placeholder="Nome do Produto" required>
            <input type="number" step="0.01" id="editar-preco-produto" placeholder="Preço do Produto" required>
            <button type="submit">Salvar Alterações</button>
        </form>
    </section>

    <section id="editar-pagamento" class="section">
        <h2>Editar Pagamento</h2>
        <form id="form-editar-pagamento">
            <input type="number" id="editar-id-mesa-pagamento" placeholder="ID da Mesa" required>
            <input type="text" id="editar-metodo-pagamento" placeholder="Método de Pagamento" required>
            <input type="number" step="0.01" id="editar-valor-pagamento" placeholder="Valor do Pagamento" required>
            <button type="submit">Salvar Alterações</button>
        </form>
    </section>
</main>

<footer>
    <p>Restaurante Webservice &copy; 2024</p>
</footer>

<script src="script.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Impedir o acesso às seções restritas até o login
        document.querySelectorAll(".restricted").forEach(link => {
            link.style.display = "none";
        });

        // Após login bem-sucedido
        document.getElementById("form-login").addEventListener("submit", function (e) {
            e.preventDefault();

            const username = document.getElementById("username-login").value.trim();
            const senha = document.getElementById("senha-login").value.trim();

            if (username === "admin" && senha === "admin") {
                alert("Login bem-sucedido!");
                document.getElementById("login").style.display = "none";
                mostrarSecao("home");
                document.querySelectorAll(".restricted").forEach(link => {
                    link.style.display = "block";
                });
            } else {
                alert("Credenciais inválidas!");
            }
        });

        // Função para mostrar a seção específica
        function mostrarSecao(sectionId) {
            document.querySelectorAll(".section").forEach(section => {
                section.classList.remove("active");
            });
            document.getElementById(sectionId).classList.add("active");
        }

        // Listar produtos na página inicial
        async function listarProdutosHome() {
            try {
                const response = await fetch("http://localhost/restaurante-webservice/produtos", {
                    method: "GET",
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    alert(`Erro ao listar produtos: ${errorData.message || response.statusText}`);
                    return;
                }

                const produtos = await response.json();
                const listaProdutosHome = document.getElementById("lista-produtos-home");
                listaProdutosHome.innerHTML = "";

                produtos.data.forEach(produto => {
                    const produtoDiv = document.createElement("div");
                    produtoDiv.classList.add("item");
                    produtoDiv.innerHTML = `
                        <p><strong>Nome:</strong> ${produto.nome}</p>
                        <p><strong>Preço:</strong> R$${produto.preco.toFixed(2)}</p>
                    `;
                    listaProdutosHome.appendChild(produtoDiv);
                });
            } catch (error) {
                console.error("Erro ao listar produtos:", error.message);
            }
        }

        listarProdutosHome();
    });
</script>
</body>
</html>
